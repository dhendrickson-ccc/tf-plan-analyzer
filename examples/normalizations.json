{
  "name_patterns": [
    {
      "pattern": "@Microsoft\\.KeyVault\\(SecretUri=https://gspiot-keyvau-[dstpb]-use2(-[a-z]?\\d{2})?\\.vault\\.azure\\.net/secrets/([^/]+)/?\\)",
      "replacement": "@Microsoft.KeyVault(<NORMALIZED>gspiot-keyvau-ENV-use2-NUM/\\2)",
      "description": "Normalize Key Vault SecretUri format (same as VaultName/SecretName format, just different syntax)"
    },
    {
      "pattern": "@Microsoft\\.KeyVault\\(VaultName=gspiot-keyvau-[dstpb]-use2(-[a-z]?\\d{2})?;SecretName=([^)]+)\\)",
      "replacement": "@Microsoft.KeyVault(<NORMALIZED>gspiot-keyvau-ENV-use2-NUM/\\2)",
      "description": "Normalize Key Vault VaultName/SecretName format (same as SecretUri format, just different syntax)"
    },
    {
      "pattern": "/subscriptions/[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}",
      "replacement": "/subscriptions/SUBSCRIPTION_ID",
      "description": "Normalize Azure subscription GUIDs in any attribute"
    },
    {
      "pattern": "gspiot-adx(cl)?-",
      "replacement": "gspiot-adx-",
      "description": "ADX cluster name variations (adx vs adxcl)"
    },
    {
      "pattern": "(gsp\\w+?)(dev|stage|test|prod)(\\.promega\\.com)$",
      "replacement": "\\1ENV\\3",
      "description": "Hostname bindings with environment prefix (e.g., gspadminstage, gspadmintest, gspadmindev)"
    },
    {
      "pattern": "^(gsp|pronect)(admin|support|inst)(svc)?(ENV|dev|stage|test|prod)?\\.promega\\.com$",
      "replacement": "APPNAME\\2\\3.promega.com",
      "description": "Normalize hostnames: preserve function (admin/support/inst) and optional svc, normalize gsp/pronect prefix and optional env token"
    },
    {
      "pattern": "(^|https?://)pronect\\.promega\\.com(?::\\d+)?($|/)",
      "replacement": "\\1gspENV.promega.com\\2",
      "description": "Normalize base app hostname pronect.promega.com to canonical gspENV.promega.com (also works for URL/port/path forms)"
    },
    {
      "pattern": "\\(gspiot-[^)]*-[dstpb]-use2-[a-z]?\\d{2}\\)",
      "replacement": "(WORKSPACE)",
      "description": "Operations Management solutions (SecurityCenterFree, SecurityInsights, etc.) - standard naming"
    },
    {
      "pattern": "\\(gspiot-opewor-[a-z0-9]{4}\\)",
      "replacement": "(WORKSPACE)",
      "description": "Operations Management solutions with opewor workspace pattern (e.g., gspiot-opewor-shqd)"
    },
    {
      "pattern": "^gspiot-opewor-[a-z0-9]{4}$",
      "replacement": "gspiot-WORKSPACE",
      "description": "Log Analytics workspace with random suffix (gspiot-opewor-XXXX)"
    },
    {
      "pattern": "(\\.windows\\.net)/[a-z0-9]{10,}$",
      "replacement": "\\1/LINK_ID",
      "description": "Private DNS zone virtual network link random suffix"
    },
    {
      "pattern": "HTTP-Settings-(gsp|pronect)(admin|support|inst)?(svc)?(ENV|dev|stage|test|prod)?\\.promega\\.com",
      "replacement": "HTTP-Settings-APPNAME\\2\\3.promega.com",
      "description": "Normalize HTTP settings: preserve function (admin/support/inst) and svc suffix, normalize gsp/pronect prefix"
    },
    {
      "pattern": "^Rule-(http|https)-(?:gspENV|gsp|pronect)(admin|support|inst)?(svc)?(ENV|dev|stage|test|prod)?\\.promega\\.com$",
      "replacement": "Rule-\\1-gspENV\\2\\3.promega.com",
      "description": "Normalize redirect rule names: collapse gsp/pronect and env suffix, preserve admin/support/inst and optional svc"
    },
    {
      "pattern": "^[a-z0-9-]+-promega-com$",
      "replacement": "ENV-promega-com",
      "description": "Certificate domains with any environment prefix (e.g., gspdev-promega-com, prnect-promega-com)"
    },
    {
      "pattern": "/staging$",
      "replacement": "/SLOT",
      "description": "Web app slot names (e.g., /staging)"
    },
    {
      "pattern": "(gspiot-[\\w-]+)-([dstpb])(-use2-[a-z]?\\d{2})\\.azurewebsites\\.net",
      "replacement": "\\1-ENV\\3.azurewebsites.net",
      "description": "Normalize Azure App Service FQDNs with environment codes"
    },
    {
      "pattern": "-([dstpb])-use2",
      "replacement": "-ENV-use2",
      "description": "Environment code in resource names (e.g., -d-, -s-, -t-, -p-)"
    },
    {
      "pattern": "gspiot-keyvau-ENV-use2(-[a-z]?\\d{2})?",
      "replacement": "gspiot-keyvau-ENV-use2-NUM",
      "description": "Key Vault names with optional numeric suffix (normalize missing suffix)"
    },
    {
      "pattern": "sa[dstpb]use2\\d{2}",
      "replacement": "saENVuse2NUM",
      "description": "Storage account env patterns"
    },
    {
      "pattern": "bnst|shqd|vapr",
      "replacement": "SUFFIX",
      "description": "Storage account suffixes - matches anywhere"
    },
    {
      "pattern": "(gspiot\\w+)lr([dstpb])e$",
      "replacement": "\\1lrENVe",
      "description": "Storage accounts with embedded env code (e.g., gspiotgenerallrde, gspiotgenerallrse)"
    },
    {
      "pattern": "-Autoscale-\\d+$",
      "replacement": "-AUTOSCALE",
      "description": "Autoscale suffix pattern (e.g., -Autoscale-729)"
    },
    {
      "pattern": "-insaut-",
      "replacement": "-AUTOSCALE-",
      "description": "Autoscale infix pattern (e.g., -insaut-)"
    },
    {
      "pattern": "-[a-z]?\\d{2}($|/)",
      "replacement": "-NUM\\1",
      "description": "Numeric suffix at end or before slash"
    },
    {
      "pattern": "(-ENV-use2)($|/)",
      "replacement": "\\1-NUM\\2",
      "description": "Missing numeric suffix after env-region"
    },
    {
      "pattern": "-[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}($|/)",
      "replacement": "-GUID\\1",
      "description": "GUID suffix"
    },
    {
      "pattern": "^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$",
      "replacement": "GUID",
      "description": "Pure GUID names"
    },
    {
      "pattern": "^gsp(dev|stage|test|prod)",
      "replacement": "gspENV",
      "description": "Certificate names starting with gsp prefix"
    },
    {
      "pattern": "gspiot-(int|inst)iotappstrfc",
      "replacement": "gspiot-PREFIXiotappstrfc",
      "description": "Traffic manager profiles"
    },
    {
      "pattern": "-instrfcweb-",
      "replacement": "-insweb-",
      "description": "Insights web test naming variations (instrfcweb -> insweb)"
    },
    {
      "pattern": "-instftcmet-",
      "replacement": "-insmet-",
      "description": "Insights metric alert naming variation (instftcmet -> insmet)"
    },
    {
      "pattern": "-instrfcmet-",
      "replacement": "-insmet-",
      "description": "Insights metric alert naming variations (instrfcmet -> insmet)"
    },
    {
      "pattern": "-insactpr-",
      "replacement": "-insact-",
      "description": "Insights activity provider variations"
    },
    {
      "pattern": "-insactys-",
      "replacement": "-insact-",
      "description": "Insights activity system variations"
    },
    {
      "pattern": "\\.vault\\.azure\\.net/secrets/[^/]+/[0-9a-f]+$",
      "replacement": ".vault.azure.net/secrets/SECRET_NAME/VERSION_ID",
      "description": "Normalize Key Vault secret URLs with version IDs (any length)"
    }
  ],
  "resource_id_patterns": [
    {
      "pattern": "/subscriptions/[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}",
      "replacement": "/subscriptions/SUBSCRIPTION_ID",
      "description": "Normalize Azure subscription GUIDs"
    },
    {
      "pattern": "/resourceGroups/([^/]+)-([dstpb])-",
      "replacement": "/resourceGroups/\\1-ENV-",
      "description": "Normalize environment code in resource group names"
    },
    {
      "pattern": "-([dstpb])-use2(-[a-z]?\\d{2})?($|/)",
      "replacement": "-ENV-use2-NUM\\3",
      "description": "Normalize environment code and optional numeric suffix in resource IDs"
    },
    {
      "pattern": "(gspiot\\w+)(bn[a-z]{2}|va[a-z]{2}|lr[a-z]{2}|sh[a-z]{2})",
      "replacement": "\\1SUFFIX",
      "description": "Normalize storage suffixes in resource IDs"
    },
    {
      "pattern": "https://([^/]+)(bn[a-z]{2}|va[a-z]{2}|lr[a-z]{2}|sh[a-z]{2})\\.([a-z]+)\\.core\\.windows\\.net",
      "replacement": "https://\\1SUFFIX.\\3.core.windows.net",
      "description": "Normalize storage URLs with environment-specific suffixes"
    },
    {
      "pattern": "https://(gspiot-[\\w-]+)-([dstpb])-use2(-[a-z]?\\d{2})?\\.vault\\.azure\\.net",
      "replacement": "https://\\1-ENV-use2-NUM.vault.azure.net",
      "description": "Normalize Key Vault URLs with environment codes and optional numeric suffix"
    },
    {
      "pattern": "([a-z0-9-]+)(dev|stage|test|prod)\\.promega\\.com",
      "replacement": "\\1ENV.promega.com",
      "description": "Normalize hostname domains with environment names"
    },
    {
      "pattern": "/roleAssignments/[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$",
      "replacement": "/roleAssignments/ROLE_ASSIGNMENT_ID",
      "description": "Normalize role assignment GUIDs in resource IDs"
    },
    {
      "pattern": "/backendHttpSettingsCollection/HTTP-Settings-(gsp|pronect)(admin|support|inst)?(svc)?(ENV|dev|stage|test|prod)?\\.promega\\.com",
      "replacement": "/backendHttpSettingsCollection/HTTP-Settings-APPNAME\\2\\3.promega.com",
      "description": "Normalize HTTP settings in resource IDs: preserve function and svc suffix"
    },
    {
      "pattern": "(/httpListeners/Listener-(?:http|https)-)(?:gspENV|gsp|pronect)(admin|support|inst)?(svc)?(ENV|dev|stage|test|prod)?\\.promega\\.com",
      "replacement": "\\1gspENV\\2\\3.promega.com",
      "description": "Normalize App Gateway listener hostnames in IDs: collapse gsp/gspENV/pronect and optional env token, preserve admin/support/inst + optional svc"
    },
    {
      "pattern": "(/redirectConfigurations/Rule-(?:http|https)-)(?:gspENV|gsp|pronect)(admin|support|inst)?(svc)?(ENV|dev|stage|test|prod)?\\.promega\\.com",
      "replacement": "\\1gspENV\\2\\3.promega.com",
      "description": "Normalize App Gateway redirect rule hostnames in IDs: collapse gsp/pronect and env suffix, preserve admin/support/inst + optional svc"
    },
    {
      "pattern": "(/requestRoutingRules/Rule-(?:http|https)-)(?:gspENV|gsp|pronect)(admin|support|inst)?(svc)?(ENV|dev|stage|test|prod)?\\.promega\\.com",
      "replacement": "\\1gspENV\\2\\3.promega.com",
      "description": "Normalize App Gateway request routing rule hostnames in IDs: collapse gsp/pronect and env suffix, preserve admin/support/inst + optional svc"
    },
    {
      "pattern": "/versions/[0-9a-f]{32}($|/)",
      "replacement": "/versions/VERSION_ID\\1",
      "description": "Normalize Key Vault secret version IDs"
    },
    {
      "pattern": "https://[^/]+\\.vault\\.azure\\.net/secrets/[^/]+/[0-9a-f]+$",
      "replacement": "https://VAULT.vault.azure.net/secrets/SECRET_NAME/VERSION_ID",
      "description": "Normalize full Key Vault secret URLs with version IDs"
    }
  ]
}
