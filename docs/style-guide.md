# Terraform Plan Analyzer - UI Style Guide

## Introduction

This style guide defines the visual design system for all HTML reports generated by the Terraform Plan Analyzer. It ensures consistency across single-plan analysis reports, multi-environment comparisons, and sensitive data obfuscation outputs.

**Purpose**: Maintain a cohesive, professional appearance across all HTML reports while enabling developers to quickly implement new UI components without studying existing code.

**Target Audience**: Developers extending the HTML report functionality, designers contributing visual improvements, and maintainers ensuring consistency.

---

## Color Palette

### Semantic Colors

All colors follow a semantic naming convention to convey meaning across different report types.

#### Primary Brand Color
- **Primary**: `#667eea` - Used for headers, section dividers, and interactive elements
- **Primary Dark**: `#764ba2` - Gradient accent color

#### Action Colors (Resource Changes)
- **Success / Added**
  - Main: `#51cf66` (bright green)
  - Background: `#d3f9d8` (light green)
  - Dark: `#2b8a3e` (forest green)
  
- **Warning / Updated**
  - Main: `#ffa94d` (orange)
  - Background: `#ffe8cc` (light orange)
  - Dark: `#e67700` (dark orange)
  - Alt Background: `#fff4e6` (cream)
  
- **Error / Removed**
  - Main: `#c92a2a` (red)
  - Background: `#ffe0e0` (light red)
  - Bright: `#ff6b6b` (bright red for badges)
  - Dark: `#7d0000` (dark red)

#### Character-Level Diff Colors
- **Character Removed**: 
  - Background: `#ff9999` (light red)
  - Text: `#7d0000` (dark red)
  
- **Character Added**:
  - Background: `#99ff99` (light green)
  - Text: `#006600` (dark green)
  
- **Character Known-After-Apply**:
  - Background: `#ffe8a1` (light yellow)
  - Text: `#995700` (dark brown)

#### Baseline Comparison Colors (Multi-Environment)
- **Baseline Removed**:
  - Background: `#bbdefb` (light blue)
  - Text: `#0d47a1` (dark blue)
  - Character: `#90caf9` / `#01579b`
  
- **Baseline Added**:
  - Background: `#e3f2fd` (very light blue)
  - Text: `#1565c0` (medium blue)

#### Neutral Colors
- **Text Primary**: `#333` (near-black)
- **Text Secondary**: `#495057` (gray)
- **Text Muted**: `#666` (medium gray)
- **Background**: `#f5f5f5` (off-white)
- **Background Secondary**: `#f8f9fa` (light gray)
- **Border**: `#e9ecef` (light gray border)

### Color Usage Guidelines

1. **Never hardcode colors** - Always use the defined palette
2. **Maintain contrast ratios** - Ensure WCAG AA compliance (4.5:1 for normal text)
3. **Use semantic colors consistently** - Green always means added, red always means removed
4. **Layer backgrounds** - Darker shades for nested content

---

## Typography

### Font Families

#### Body Text (Sans-Serif)
```css
font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
```
**Usage**: All body text, headers, buttons, labels

#### Code / Monospace
```css
font-family: Monaco, Menlo, Consolas, 'Courier New', monospace;
```
**Usage**: Resource names, file paths, JSON content, configuration values

### Font Sizes

| Element | Size | Line Height | Usage |
|---------|------|-------------|-------|
| H1 (Page Title) | `2.5em` | `1.2` | Main report title |
| H2 (Section Header) | `1.8em` | `1.3` | Major section dividers |
| Summary Card Number | `2.5em` | `1.0` | Metric displays |
| Body Text | `16px` | `1.6` | Default paragraphs |
| Code/Monospace | `14px` (0.85-0.9em) | `1.5` | JSON, resource names |
| Small Text | `0.75-0.85em` | `1.4` | Badges, labels |

### Font Weights

- **Normal**: `400` - Body text, descriptions
- **Medium**: `500` - Emphasis, labels
- **Bold**: `700` (`bold`) - Headers, important values

### Typography Examples

```html
<!-- Page Title -->
<h1 style="font-size: 2.5em; margin-bottom: 10px;">Terraform Plan Analysis</h1>

<!-- Section Header -->
<h2 class="section-header">Resource Changes</h2>

<!-- Code Text -->
<span style="font-family: Monaco, Menlo, Consolas, monospace; font-size: 0.9em;">
  aws_instance.web_server
</span>
```

---

## Spacing System

Consistent spacing creates visual rhythm and improves readability.

### Padding

| Context | Value | Usage |
|---------|-------|-------|
| Card Padding | `24px` | `.summary-card`, `.resource-change-content` |
| Section Padding | `30px` | `.section` header and body |
| Inline Padding (Small) | `8px 12px` | `.diff-header`, badges |
| Inline Padding (Medium) | `10px 15px` | Buttons, input fields |
| Inline Padding (Large) | `15px 20px` | `.resource-change-header` |
| Page Padding | `20px` | Body element |

### Margin

| Context | Value | Usage |
|---------|-------|-------|
| Section Bottom | `30px` | `.resource-type-section` |
| Card Bottom | `20px` | `.resource-change` |
| Element Bottom | `10px` | Headers, paragraphs |
| Small Element Bottom | `5px` | Labels, inline text |
| Between Cards | `16px` | Grid gap in resource lists |

### Border Radius

| Element | Radius | Usage |
|---------|--------|-------|
| Cards | `8px` | `.container`, `.resource-change`, `.summary-card` |
| Buttons | `5-6px` | `.toggle-all`, interactive elements |
| Badges | `4px` | `.sensitive-badge`, status indicators |
| Small Elements | `3px` | Inline code, small highlights |

### Gap (Grid/Flex)

| Layout | Gap | Usage |
|--------|-----|-------|
| Summary Cards | `20px` | `.summary` grid |
| Resource List | `10px` | `.resource-list` grid |
| Diff Columns | `20px` | `.change-diff` grid |
| Inline Flex | `10-12px` | `.resource-change-header` flex items |

---

## CSS Classes Reference

### Summary Cards

```html
<!-- Total Resources Card -->
<div class="summary-card total">
  <div class="number">42</div>
  <div class="label">Total Resources</div>
</div>

<!-- Created Resources Card -->
<div class="summary-card created">
  <div class="number">5</div>
  <div class="label">Created</div>
</div>

<!-- Updated Resources Card -->
<div class="summary-card updated">
  <div class="number">12</div>
  <div class="label">Updated</div>
</div>

<!-- Deleted Resources Card -->
<div class="summary-card deleted">
  <div class="number">3</div>
  <div class="label">Deleted</div>
</div>
```

**Styling**:
- `.summary-card` - Base card with white background, padding, shadow
- `.summary-card .number` - Large bold number with semantic color
- `.summary-card .label` - Uppercase label in gray
- `.total` - Purple color (`#667eea`)
- `.created` - Green color (`#51cf66`)
- `.updated` - Orange color (`#ffa94d`)
- `.deleted` - Red color (`#ff6b6b`)

### Resource Cards

```html
<!-- Expandable Resource Change Card -->
<div class="resource-change">
  <div class="resource-change-header">
    <span class="toggle-icon">▼</span>
    <span class="resource-name">aws_instance.web_server</span>
  </div>
  <div class="resource-change-content">
    <!-- Change details here -->
  </div>
</div>
```

**Styling**:
- `.resource-change` - White card with border and rounded corners
- `.resource-change-header` - Gray background with orange bottom border
- `.toggle-icon` - Clickable arrow (rotates when collapsed)
- `.resource-name` - Monospace font for resource identifier
- `.resource-change-content` - Padded content area (can be hidden)

### Diff Highlighting

```html
<!-- Line-Level Diff -->
<div class="removed">- old value</div>
<div class="added">+ new value</div>
<div class="unchanged">  same value</div>

<!-- Character-Level Diff -->
<div>
  The <span class="char-removed">old</span><span class="char-added">new</span> value
</div>

<!-- Known After Apply -->
<div class="known-after-apply">(known after apply)</div>
```

**Classes**:
- `.removed` - Light red background (`#ffe0e0`), dark red text
- `.added` - Light green background (`#d3f9d8`), dark green text
- `.unchanged` - Gray text, no background
- `.char-removed` - Bright red background for character-level changes
- `.char-added` - Bright green background for character-level changes
- `.known-after-apply` - Light orange background, orange text

### JSON Content

```html
<div class="diff-column">
  <div class="diff-header before">Before</div>
  <pre class="json-content">{
  "instance_type": "t2.micro",
  "ami": "ami-12345"
}</pre>
</div>
```

**Styling**:
- `.json-content` - Monospace font, pre-wrap, scrollable
- `.diff-header` - Bold uppercase label
- `.diff-header.before` - Red background
- `.diff-header.after` - Green background
- `.diff-header.after-unknown` - Orange background

### Badges

```html
<span class="sensitive-badge">SENSITIVE</span>
```

**Styling**: Red background (`#ff6b6b`), white text, small size, rounded

---

## Component Patterns

### Pattern 1: Summary Card with Icon and Number

```html
<div class="summary">
  <div class="summary-card created">
    <div class="number">5</div>
    <div class="label">Resources Created</div>
  </div>
  <div class="summary-card updated">
    <div class="number">12</div>
    <div class="label">Resources Updated</div>
  </div>
</div>
```

**CSS** (from `src/lib/html_generation.py`):
```css
.summary {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
  gap: 20px;
  padding: 30px;
  background: #f8f9fa;
}

.summary-card {
  background: white;
  padding: 20px;
  border-radius: 8px;
  box-shadow: 0 2px 5px rgba(0,0,0,0.05);
  text-align: center;
}

.summary-card.created .number { color: #51cf66; }
```

### Pattern 2: Resource Comparison Card with Diff

```html
<div class="resource-change">
  <div class="resource-change-header">
    <span class="toggle-icon">▼</span>
    <span class="resource-name">aws_instance.web</span>
  </div>
  <div class="resource-change-content">
    <div class="change-item">
      <div class="change-attribute">
        instance_type
        <span class="sensitive-badge">SENSITIVE</span>
      </div>
      <div class="change-diff">
        <div class="diff-column">
          <div class="diff-header before">Before</div>
          <pre class="json-content">t2.micro</pre>
        </div>
        <div class="diff-column">
          <div class="diff-header after">After</div>
          <pre class="json-content">t2.small</pre>
        </div>
      </div>
    </div>
  </div>
</div>
```

### Pattern 3: Expandable Section with Toggle

```html
<div class="resource-change">
  <div class="resource-change-header" onclick="toggleSection(this)">
    <span class="toggle-icon">▼</span>
    <span class="resource-name">Section Title</span>
  </div>
  <div class="resource-change-content">
    Content goes here...
  </div>
</div>

<script>
function toggleSection(header) {
  const icon = header.querySelector('.toggle-icon');
  const content = header.nextElementSibling;
  
  icon.classList.toggle('collapsed');
  content.classList.toggle('hidden');
}
</script>
```

**CSS**:
```css
.toggle-icon {
  cursor: pointer;
  transition: transform 0.3s;
}

.toggle-icon.collapsed {
  transform: rotate(-90deg);
}

.resource-change-content.hidden {
  display: none;
}
```

### Pattern 4: Badge Components

```html
<!-- Sensitive Data Badge -->
<span class="sensitive-badge">SENSITIVE</span>

<!-- Custom Badge (create similar patterns) -->
<span style="background: #667eea; color: white; padding: 2px 8px; border-radius: 4px; font-size: 0.75em;">
  NEW
</span>
```

### Pattern 5: Badge with Tooltip (Feature 007)

Badges can display detailed information on hover using HTML `title` attribute and CSS pseudo-elements.

```html
<!-- Badge with tooltip showing breakdown -->
<span class="badge" title="Config Ignored: 3&#10;Normalized: 2" 
      style="background: #e67700; color: white; padding: 2px 8px; border-radius: 4px; font-size: 0.75em;">
  5 attributes ignored
</span>
```

**CSS Implementation** (from `src/lib/html_generation.py`):
```css
/* Make container allow tooltip overflow */
.resource-change-header {
  overflow: visible !important;
}

/* Tooltip trigger */
.badge[title] {
  position: relative;
  cursor: help;  /* Show help cursor on hover */
}

/* Tooltip content bubble */
.badge[title]:hover::after {
  content: attr(title);
  position: absolute;
  bottom: calc(100% + 10px);  /* Position above badge */
  left: 50%;
  transform: translateX(-50%);  /* Center horizontally */
  padding: 8px 12px;
  background: #1f2937;  /* Dark gray */
  color: white;
  font-size: 0.85em;
  font-weight: normal;
  border-radius: 6px;
  white-space: nowrap;  /* Prevent wrapping */
  z-index: 99999;  /* Always on top */
  box-shadow: 0 4px 12px rgba(0,0,0,0.3);
  pointer-events: none;  /* Don't block clicks */
}

/* Tooltip arrow pointing down to badge */
.badge[title]:hover::before {
  content: '';
  position: absolute;
  bottom: calc(100% + 4px);
  left: 50%;
  transform: translateX(-50%);
  border: 6px solid transparent;
  border-top-color: #1f2937;  /* Match tooltip background */
  z-index: 99999;
  pointer-events: none;
}
```

**Usage Guidelines**:
- Use `&#10;` for line breaks in `title` attribute (renders as newline in tooltip)
- Keep tooltip text concise (max 3-4 lines)
- Use for detailed breakdowns (e.g., "Config Ignored: 3" + "Normalized: 2")
- Default badge cursor changes to `help` to indicate interactivity
- Tooltip appears 10px above badge with arrow pointing down
- Dark background (#1f2937) ensures readability against any page color

**Example with Multi-Line Breakdown**:
```html
<span class="badge" 
      title="Ignored Attributes:&#10;  Config: 3 (tags, description, timeouts)&#10;  Normalized: 2 (name, location)"
      style="background: #e67700; color: white; padding: 2px 8px; border-radius: 4px; font-size: 0.75em;">
  5 ignored
</span>
```

### Pattern 6: Button Styles

```html
<button class="toggle-all" onclick="toggleAllSections()">
  Expand All
</button>
```

**CSS**:
```css
.toggle-all {
  background: #667eea;
  color: white;
  border: none;
  padding: 10px 20px;
  border-radius: 5px;
  cursor: pointer;
  font-size: 1em;
}

.toggle-all:hover {
  background: #5568d3;
}
```

---

## Layout Guidelines

### Container Structure

```html
<body>
  <div class="container">
    <header>
      <h1>Report Title</h1>
      <p>Subtitle or description</p>
    </header>
    
    <div class="summary">
      <!-- Summary cards -->
    </div>
    
    <div class="section">
      <h2 class="section-header">Section Title</h2>
      <!-- Section content -->
    </div>
  </div>
</body>
```

**Constraints**:
- Container max-width: `1400px`
- Container centered with `margin: 0 auto`
- White background with shadow for elevation
- Rounded corners (`8px`) for modern appearance

### Grid Patterns

#### 2-Column Grid (Diff Comparison)
```css
.change-diff {
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 20px;
}
```

#### 3-4 Column Grid (Summary Cards)
```css
.summary {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
  gap: 20px;
}
```

#### Auto-Fill Grid (Resource List)
```css
.resource-list {
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
  gap: 10px;
}
```

### Flexbox Patterns

#### Horizontal Layout with Gap
```css
.resource-change-header {
  display: flex;
  align-items: center;
  gap: 10px;
}
```

**Common Flex Properties**:
- `align-items: center` - Vertical centering
- `justify-content: space-between` - Space items apart
- `gap: 10-20px` - Space between flex items
- `flex: 1` - Grow to fill available space

### Responsive Breakpoints

```css
@media (max-width: 768px) {
  .change-diff {
    grid-template-columns: 1fr; /* Stack on mobile */
  }
  
  .summary {
    grid-template-columns: 1fr; /* One column on mobile */
  }
}
```

**Breakpoints**:
- Desktop: `> 768px` - Multi-column layouts
- Mobile: `≤ 768px` - Single-column stacked layouts

---

## Usage Examples

### How to Import Styles

```python
from src.lib.html_generation import generate_full_styles

# Generate complete CSS for HTML report
styles = generate_full_styles()

html_report = f"""
<!DOCTYPE html>
<html>
<head>
  <title>Terraform Plan Analysis</title>
  {styles}
</head>
<body>
  <!-- Report content -->
</body>
</html>
"""
```

### How to Apply Semantic Colors

```python
# For resource changes
if change_type == "create":
    card_class = "created"  # Green (#51cf66)
elif change_type == "update":
    card_class = "updated"  # Orange (#ffa94d)
elif change_type == "delete":
    card_class = "deleted"  # Red (#ff6b6b)
else:
    card_class = "total"    # Purple (#667eea)

html = f'<div class="summary-card {card_class}">...</div>'
```

### Creating a New Component

When adding a new UI element:

1. **Choose semantic colors** from the Color Palette section
2. **Apply spacing** using the Spacing System values
3. **Use typography** from the Typography section
4. **Follow existing patterns** from Component Patterns
5. **Test responsive behavior** at mobile breakpoints

Example - Creating a "Warning Card":

```html
<div class="summary-card" style="border-left: 4px solid #ffa94d;">
  <div class="number" style="color: #ffa94d;">3</div>
  <div class="label">Warnings</div>
</div>
```

### Modifying Existing Styles

To modify colors or spacing:

1. **Update `src/lib/html_generation.py`** - The single source of truth
2. **Update this style guide** - Keep documentation in sync
3. **Test all report types** - Single-plan, multi-env, obfuscation
4. **Verify accessibility** - Check contrast ratios

---

## Best Practices

### DO ✓
- Use the defined color palette for all new components
- Maintain consistent spacing (multiples of 4-8px)
- Apply monospace fonts for technical content (resource names, JSON)
- Use semantic class names (`.created`, `.updated`, not `.green`, `.orange`)
- Test responsive behavior on mobile viewports
- Ensure 4.5:1 contrast ratio for text readability

### DON'T ✗
- Hardcode colors outside the defined palette
- Mix padding/margin values arbitrarily
- Use system fonts for code/JSON content
- Create color-based class names (`.red-text`, `.blue-background`)
- Assume desktop-only usage
- Use pure black (`#000`) or pure white (`#fff`) for text

---

## Quick Reference

### Most Common Classes

| Class | Purpose |
|-------|---------|
| `.summary-card` | Metric display cards |
| `.resource-change` | Expandable resource detail card |
| `.removed` | Removed/deleted content (red) |
| `.added` | Added/created content (green) |
| `.char-removed` | Character-level deletion highlight |
| `.char-added` | Character-level addition highlight |
| `.json-content` | JSON/code display with monospace font |
| `.sensitive-badge` | Sensitive data indicator |
| `.toggle-icon` | Collapsible section arrow |
| `.notes-container` | Wrapper for question/answer notes fields |
| `.note-field` | Textarea for question or answer input |
| `.note-label` | Label for notes textareas |

### Most Common Colors

| Color | Hex | Usage |
|-------|-----|-------|
| Primary | `#667eea` | Headers, links, total counts |
| Success | `#51cf66` | Created resources, additions |
| Warning | `#ffa94d` | Updated resources, changes |
| Error | `#c92a2a` | Deleted resources, removals |
| Neutral Gray | `#495057` | Body text, descriptions |

### Most Common Spacing

| Value | Usage |
|-------|-------|
| `8px` | Small padding/gap |
| `12px` | Medium inline padding |
| `20px` | Card gaps, general spacing |
| `24px` | Card padding |
| `30px` | Section padding |

---

## Notes Components

Added in feature 008-attribute-notes for question/answer annotations on attribute changes.

### Notes Container

**Class**: `.notes-container`

```css
.notes-container {
    margin-top: 15px;
    padding: 15px;
    background: #f8f9fa;
    border-radius: 4px;
    border-left: 3px solid #6c757d;
}
```

**Usage**: Wrapper for question and answer text fields below each attribute change.

### Note Label

**Class**: `.note-label`

```css
.note-label {
    display: block;
    font-weight: 600;
    color: #495057;
    margin-bottom: 5px;
    font-size: 0.9em;
}
```

**Usage**: Label element for question/answer textareas with `for` attribute linking to field ID.

**HTML Example**:
```html
<label class="note-label" for="note-q-aws_instance-web-instance_type">
  Question:
</label>
```

### Note Field

**Class**: `.note-field`

```css
.note-field {
    width: 100%;
    padding: 10px;
    border: 1px solid #ced4da;
    border-radius: 4px;
    font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, ...;
    font-size: 0.95em;
    line-height: 1.5;
    resize: vertical;
    background: white;
    transition: border-color 0.15s ease-in-out, box-shadow 0.15s ease-in-out;
}
```

**Focus State**:
```css
.note-field:focus {
    outline: none;
    border-color: #667eea;  /* Primary brand color */
    box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
}
```

**Placeholder**:
```css
.note-field::placeholder {
    color: #adb5bd;
    font-style: italic;
}
```

**Usage**: Textarea element for question or answer input. Auto-saves to browser LocalStorage on input (debounced 500ms).

**HTML Example**:
```html
<textarea 
  class="note-field" 
  id="note-q-aws_instance-web-instance_type"
  placeholder="Add a question..."
  oninput="debouncedSaveNote('aws_instance.web', 'instance_type', 'question', this.value)"
  rows="4">
</textarea>
```

### Note Answer

**Class**: `.note-answer`

```css
.note-answer {
    margin-top: 12px;
}
```

**Usage**: Wrapper div for answer field to add spacing between question and answer textareas.

### Complete Notes Structure

```html
<div class="notes-container">
    <div>
        <label class="note-label" for="note-q-{resource}-{attribute}">
            Question:
        </label>
        <textarea 
            class="note-field" 
            id="note-q-{resource}-{attribute}"
            placeholder="Add a question..."
            rows="4">
        </textarea>
    </div>
    <div class="note-answer">
        <label class="note-label" for="note-a-{resource}-{attribute}">
            Answer:
        </label>
        <textarea 
            class="note-field" 
            id="note-a-{resource}-{attribute}"
            placeholder="Add an answer..."
            rows="4">
        </textarea>
    </div>
</div>
```

**Browser Persistence**: Notes automatically save to `localStorage` with key pattern:
```
tf-notes-{reportFilename}#{resourceAddress}#{attributeName}
```

**Related**: See [get_notes_css()](function-glossary.md#get_notes_css) and [get_notes_javascript()](function-glossary.md#get_notes_javascript) for implementation

---

## Version History

- **v1.0** (January 2026) - Initial style guide created for spec 005-cleanup-and-refactor
- Reflects implementation in `src/lib/html_generation.py` as of commit f8867a3

---

## Related Documentation

- [HTML Generation Source Code](../src/lib/html_generation.py) - Implementation of all CSS
- [Multi-Environment Comparator](../src/core/multi_env_comparator.py) - Usage examples
- [Single Plan Analyzer](../src/cli/analyze_plan.py) - Report generation

For questions or suggestions, refer to the project README or open an issue.
